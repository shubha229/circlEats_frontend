<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CirclEats | Donor Dashboard</title>
<link rel="icon" href="assets/logo.jpg" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v9.1.0/ol.css" />
<script src="https://cdn.jsdelivr.net/npm/ol@v9.1.0/dist/ol.js"></script>
<style>
/* === GLOBAL === */
body {
  margin: 0;
  font-family: "Inter", sans-serif;
  background: linear-gradient(135deg, #f0fdf4 0%, #ecfeff 40%, #e0f2fe 100%);
  color: #1f2937;
}

/* === NAVBAR === */
header.navbar {
  background: #ffffffcc;
  backdrop-filter: blur(10px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  position: sticky;
  top: 0;
  z-index: 50;
}
.navbar nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.8rem 1.5rem;
}
.brand {
  display: flex;
  align-items: center;
  gap: 0.6rem;
}
.brand img {
  width: 42px;
  height: 42px;
  border-radius: 0.5rem;
}
.brand span {
  font-weight: 700;
  color: #0f766e;
  font-size: 1.3rem;
}
.nav-links {
  display: flex;
  gap: 0.5rem;
}
.nav-btn {
  padding: 0.5rem 1rem;
  border-radius: 0.6rem;
  border: none;
  background: transparent;
  font-weight: 500;
  color: #0f172a;
  cursor: pointer;
  transition: all 0.25s ease;
}
.nav-btn:hover {
  background-color: #f3f4f6;
}
.nav-btn.active {
  background-color: #0f766e;
  color: white;
  box-shadow: 0 2px 5px rgba(15, 118, 110, 0.3);
}
.lang-select {
  border: 1px solid #d1d5db;
  border-radius: 0.4rem;
  padding: 0.25rem 0.5rem;
  font-size: 0.85rem;
  outline: none;
  cursor: pointer;
}

/* === PAGE HEADER === */
.page-header {
  text-align: center;
  background: linear-gradient(to right, #ecfdf5, #e0f2fe);
  padding: 2rem 1rem;
  box-shadow: inset 0 -2px 4px rgba(0, 0, 0, 0.03);
}
.page-header h1 {
  color: #065f46;
  font-size: 2.5rem;
  font-weight: 800;
  margin-bottom: 0.5rem;
}
.page-header p {
  color: #374151;
  font-size: 1rem;
}

/* === MAIN === */
main {
  max-width: 900px;
  margin: 2rem auto;
  padding: 0 1rem;
}
.card {
  background: #ffffffdd;
  backdrop-filter: blur(6px);
  border: 1px solid #d1fae5;
  border-radius: 1rem;
  padding: 1.8rem;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
  margin-bottom: 2rem;
}
.card h2 {
  color: #0f766e;
  font-size: 1.6rem;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  gap: 0.4rem;
}
label {
  display: block;
  font-weight: 500;
  margin: 0.8rem 0 0.3rem;
}
input,
select {
  width: 100%;
  padding: 0.6rem;
  border: 1px solid #d1d5db;
  border-radius: 0.5rem;
  font-family: inherit;
  font-size: 1rem;
}
button.submit {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: #0f766e;
  color: white;
  border: none;
  border-radius: 0.6rem;
  padding: 0.7rem 1.2rem;
  font-weight: 600;
  cursor: pointer;
  transition: 0.25s;
  margin-top: 1rem;
}
button.submit:hover {
  background: #115e59;
}

/* === MAP === */
#map {
  width: 100%;
  height: 300px;
  border-radius: 0.75rem;
  border: 1px solid #d1d5db;
  margin-top: 0.5rem;
}

/* === IMAGE PREVIEW === */
#image-preview {
  margin-top: 0.5rem;
  text-align: center;
}
#image-preview img {
  max-width: 150px;
  border-radius: 0.5rem;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

/* === FOOTER === */
footer {
  text-align: center;
  color: #6b7280;
  padding: 1rem;
  border-top: 1px solid #e5e7eb;
  margin-top: 2rem;
}
</style>
</head>

<body>
<!-- ‚úÖ Navbar -->
<header class="navbar">
  <nav>
    <div class="brand">
      <img src="assets/logo.jpg" alt="CirclEats" />
      <span>CirclEats</span>
    </div>
    <div class="nav-links">
      <button class="nav-btn active">Donor</button>
      <button onclick="window.location.href='volunteer.html'" class="nav-btn">Volunteer</button>
      <button onclick="window.location.href='shelter.html'" class="nav-btn">Shelter</button>
      <button onclick="window.location.href='user-dashboard.html'" class="nav-btn">Profile</button>
    </div>
    <select class="lang-select">
      <option>English</option>
      <option>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
      <option>‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
      <option>‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
    </select>
  </nav>
</header>

<!-- ‚úÖ Header -->
<section class="page-header">
  <h1>Donor Dashboard</h1>
  <p>Create and manage your food donations üå±</p>
</section>

<!-- ‚úÖ Main -->
<main>
  <div class="card">
    <h2>üßæ Create Donation</h2>
    <form id="donation-form">
      <label>üç≤ Food Type</label>
      <select id="food-type">
        <option value="">Select</option>
        <option>Cooked Meals</option>
        <option>Bakery Items</option>
        <option>Fruits</option>
        <option>Vegetables</option>
      </select>

      <label>ü•ò Food Name (optional)</label>
      <input id="food-name" type="text" placeholder="e.g. Paneer Curry, Bread Loaf" />

      <label>üçΩ Quantity (Servings)</label>
      <input id="quantity" type="number" min="1" />

      <label>‚è∞ Expiry Date & Time</label>
      <input id="expiry" type="datetime-local" />

      <label>üì∏ Food Image (optional)</label>
      <input id="food-image" type="file" accept="image/*" onchange="previewImage(event)" />
      <div id="image-preview"></div>

      <label>üìç Location</label>
      <input id="location-input" type="text" placeholder="Enter address or click map below" />
      <div id="map"></div>

      <button type="submit" class="submit">‚ûï Create Listing</button>
    </form>
  </div>

  <div class="card">
    <h2>üì¶ My Listings</h2>
    <p id="listing-cards">Loading listings‚Ä¶</p>
  </div>
</main>

<footer>¬© 2025 CirclEats | Empowering Generosity üíö</footer>

<!-- ‚úÖ JS -->
<script>
/* === Image Preview === */
function previewImage(event) {
  const file = event.target.files[0];
  const preview = document.getElementById("image-preview");
  preview.innerHTML = "";
  if (file) {
    const img = document.createElement("img");
    img.src = URL.createObjectURL(file);
    preview.appendChild(img);
  }
}

/* === Map Logic === */
window.addEventListener("load", () => {
  const map = new ol.Map({
    target: "map",
    layers: [new ol.layer.Tile({ source: new ol.source.OSM() })],
    view: new ol.View({
      center: ol.proj.fromLonLat([78.9629, 20.5937]),
      zoom: 4,
    }),
  });

  map.on("click", async (evt) => {
    const coord = ol.proj.toLonLat(evt.coordinate);
    const [lon, lat] = coord;
    const vectorSource = new ol.source.Vector({
      features: [new ol.Feature(new ol.geom.Point(ol.proj.fromLonLat([lon, lat])))],
    });
    const markerStyle = new ol.style.Style({
      image: new ol.style.Icon({
        src: "https://cdn-icons-png.flaticon.com/512/854/854878.png",
        scale: 0.07,
      }),
    });
    const vectorLayer = new ol.layer.Vector({ source: vectorSource, style: markerStyle });
    map.getLayers().getArray().slice(1).forEach((l) => map.removeLayer(l));
    map.addLayer(vectorLayer);

    // Reverse Geocode
    try {
      const res = await fetch(
        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`
      );
      const data = await res.json();
      if (data.display_name) {
        document.getElementById("location-input").value = data.display_name;
      }
    } catch (err) {
      console.warn("Geocode failed", err);
    }
  });
});
</script>
</body>
</html>
